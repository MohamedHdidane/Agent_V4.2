# 🛡️ `priv_esc` Command – Local Privilege Escalation Enumerator

The `priv_esc` command automates the enumeration of misconfigurations and vulnerabilities that could lead to privilege escalation on a Linux system.

This command is useful for red team operators and penetration testers to identify common privilege escalation vectors on compromised systems.

---

## ✅ Usage Syntax

```bash
priv_esc
```

> No arguments required. The command performs an extensive local enumeration and returns structured results.

---

## 🔍 What It Checks

| Category               | Description                                                                 |
|------------------------|-----------------------------------------------------------------------------|
| **Sudo Privileges**    | Checks for passwordless or unrestricted `sudo` permissions.                 |
| **Privileged Groups**  | Detects if the user is part of sensitive groups like `sudo`, `docker`, etc. |
| **Critical File Perms**| Finds world/group-writable or readable sensitive files (`/etc/shadow`, etc.)|
| **SUID/SGID Binaries** | Identifies risky or custom SUID/SGID binaries in system paths.              |
| **Capabilities**       | Uses `getcap` to identify binaries with dangerous capabilities.             |
| **Kernel Info**        | Flags vulnerable or outdated kernel versions (e.g., Dirty COW).             |
| **Cron Permissions**   | Checks for writable or user-owned cron jobs or crontab files.               |
| **Environment Vars**   | Finds risky environment variables like `LD_PRELOAD`, `PATH`, etc.           |
| **Process Info**       | Lists root-owned processes related to services.                             |
| **Network Services**   | Lists processes listening on all interfaces.                                |
| **World-Writable Files**| Finds such files in `/etc`, `/usr`, `/opt`, `/tmp`, etc.                   |
| **SSH Key Exposure**   | Detects accessible or writable private keys and `authorized_keys`.          |
| **Docker Socket**      | Checks for access to Docker socket and group.                               |
| **Mount Points**       | Detects NFS/SSHFS mounts that may have lax permissions.                     |

---

## 📤 Output Example – Enumeration Report

> This section shows a sample report generated by the `priv_esc` command. It groups findings by severity (HIGH, MEDIUM, INFO), includes timestamps, and summarizes the results.


```
================================================================================
PRIVILEGE ESCALATION ENUMERATION REPORT
================================================================================
Scan Date: 2025-06-21T04:08:13.271774
Target User: mydesktop (UID: 1000)
System: Linux 6.11.0-26-generic
================================================================================

[HIGH] FINDINGS (3):
--------------------------------------------------
Check: privileged groups
Result: User in privileged groups: sudo, adm
Time: 2025-06-21T04:08:13.058338

Check: ssh keys
Result: Writable authorized_keys: /home/mydesktop/.ssh/authorized_keys
Time: 2025-06-21T04:08:13.271774

Check: ssh keys
Result: Writable authorized_keys: /home/mydesktop/.ssh/authorized_keys
Time: 2025-06-21T04:08:13.271813

[MEDIUM] FINDINGS (12):
--------------------------------------------------
Check: suid sgid binaries
Result: SGID binary: /usr/bin/crontab (crontab)
Time: 2025-06-21T04:08:13.168578

Check: suid sgid binaries
Result: SGID binary: /usr/bin/expiry (expiry)
Time: 2025-06-21T04:08:13.168589

Check: suid sgid binaries
Result: SGID binary: /usr/bin/chage (chage)
Time: 2025-06-21T04:08:13.168591

Check: suid sgid binaries
Result: SGID binary: /usr/bin/ssh-agent (ssh-agent)
Time: 2025-06-21T04:08:13.168592

Check: suid sgid binaries
Result: SGID binary: /usr/sbin/unix_chkpwd (unix_chkpwd)
Time: 2025-06-21T04:08:13.168594

Check: suid sgid binaries
Result: SGID binary: /usr/sbin/pam_extrausers_chkpwd (pam_extrausers_chkpwd)
Time: 2025-06-21T04:08:13.168595

Check: suid sgid binaries
Result: SUID binary: /opt/VBoxGuestAdditions-7.1.6/bin/VBoxDRMClient (VBoxDRMClient)
Time: 2025-06-21T04:08:13.168596

Check: capabilities
Result: File with capabilities: /usr/bin/ping cap_net_raw=ep
Time: 2025-06-21T04:08:13.177332

Check: capabilities
Result: File with capabilities: /usr/bin/dumpcap cap_net_admin,cap_net_raw=eip
Time: 2025-06-21T04:08:13.177340

Check: capabilities
Result: File with capabilities: /usr/bin/mtr-packet cap_net_raw=ep
Time: 2025-06-21T04:08:13.177342

Check: root processes
Result: Services running as root:
sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
Time: 2025-06-21T04:08:13.198644

Check: network services
Result: Services listening on all interfaces: :::22 (port 22), :::21 (port 21)
Time: 2025-06-21T04:08:13.211082

[INFO] FINDINGS (4):
--------------------------------------------------
Check: system info
Result: User: mydesktop, UID: 1000, GID: 1000
Time: 2025-06-21T04:07:58.010473

Check: sudo privileges
Result: No sudo privileges detected
Time: 2025-06-21T04:08:13.042002

Check: kernel version
Result: Kernel version: 6.11.0-26-generic
Time: 2025-06-21T04:08:13.184793

Check: ssh keys
Result: SSH agent socket found: /run/user/1000/keyring/ssh
Time: 2025-06-21T04:08:13.271834

================================================================================
SUMMARY:
Total findings: 19
High: 3
Medium: 12
Info: 4
================================================================================
```

---

